services:
  globalprotect:
    build:
      context: .
      dockerfile: docker/Dockerfile
      args:
        # Set USE_XVFB=1 for LXC/Proxmox compatibility (uses Xvfb + x11vnc)
        USE_XVFB: ${USE_XVFB:-0}
    image: globalprotect-docker:vnc-autofill
    hostname: globalprotect
    restart: unless-stopped
    tty: true
    shm_size: '512m'
    env_file:
      - path: .env
        required: false
    volumes:
      - ${GP_CONFIG_PATH:-./config/com.yuezk.qt}:/root/.config/com.yuezk.qt
    devices:
      - /dev/net/tun
    cap_add:
      - NET_ADMIN
    ports:
      - 8083:8083
      - 8090:1080
    networks:
      - globalprotect

networks:
  globalprotect:
    external: false
    name: globalprotect
